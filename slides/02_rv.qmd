---
title: "確率論"
subtitle: "確率変数"
author: "森 立平"
format:
  revealjs:
    slide-number: true
    smaller: true
    html-math-method: mathjax
    include-in-header: macros.qmd
jupyter: python3
css: slides.css
---

## 確率空間の公理

確率空間 $(\Omega,\,P)$ の公理

- $\Omega\colon$ (**非可算**でもよい)集合(**標本空間**)
- $P\colon 2^\Omega\to\mathbb{R}_{\ge 0}$ (**確率測度**)


:::{.wide-list}
1. $P(\Omega)=1$.
<!-- 2. ~~$\forall A, B\subseteq\Omega$, $A\cap B=\varnothing\implies P(A\cup B)=P(A)+P(B)$\ (有限加法性).~~ -->
1. $\forall (A_n\subseteq\Omega)_{n\ge 0}$, $\forall i\ne j,\, A_i\cap A_j=\varnothing\implies P\left(\bigcup_{n\ge0} A_n\right)=\sum_{n\ge0} P(A_n)$\ (**完全加法性, $\sigma$-加法性**).
:::

:::{.r-stack}
本当は正しくないけど
:::

## 確率空間の例

一回のコイン投げ

:::{.wide-list}
- $\Omega = \{\mathrm{H},\mathrm{T}\}$.
- $P(A) = \frac{|A|}2\qquad\forall A\subseteq\Omega$.
:::

二回の独立なコイン投げ

:::{.wide-list}
- $\Omega = \{\mathrm{HH},\mathrm{HT},\mathrm{TH},\mathrm{TT}\}$.
- $P(A) = \frac{|A|}4\qquad\forall A\subseteq\Omega$.
:::

無限回の独立なコイン投げ

:::{.wide-list}
- $\Omega = \{\mathrm{H},\mathrm{T}\}^{\mathbb{N}}$.
- $P(A) = \frac{|A|}4\qquad\forall A\subseteq\Omega$.
:::

実数

:::{.wide-list}
- $\Omega = [0,1)$.
- $P([a,b)) = b-a\qquad\forall A\subseteq\Omega$.
:::

## 確率変数
実際に知りたい情報は限定されている。

$100$ 回コインを投げると $2^{100}$ 通りの結果があるが、興味がある情報は例えば以下のものなど。

:::{.wide-list}
- $k$ 回目に表が出たか裏が出たか
- 表が出た回数
- 二回連続同じ面が出た回数
- 連続して何回表が出たか
:::

:::{.definition}

**確率変数**

$(\Omega,\,P)$ を確率空間とするとき、関数 $X\colon \Omega\to\mathbb{R}$ を確率変数とよぶ。
また、実数 $a\in\mathbb{R}$ について
\begin{align*}
\Pr(X\le a) &\coloneqq P(\left\{\omega\in\Omega\mid X(\omega)\le a\right\})
\end{align*}
と表す。
$\Pr(X\ge a),\,\Pr(X=a),\,\Pr(X<a),\,\Pr(X>a)$ なども同様に定義される。

:::

例えば、$\Omega=\{\mathrm{HH},\mathrm{HT},\mathrm{TH},\mathrm{TT}\}$ のとき、.

\begin{align*}
X_1(\mathrm{HH}) &= X_1(\mathrm{HT}) = 1,& X_1(\mathrm{TH}) = X_1(\mathrm{TT}) = 0\\
X_2(\mathrm{HH}) &= X_2(\mathrm{TH}) = 1,& X_2(\mathrm{HT}) = X_2(\mathrm{TT}) = 0\\
X&=X_1+X_2
\end{align*}

## 離散型確率変数

**離散型確率変数**: 像が高々可算無限の確率変数

任意の $A\subseteq\mathrm{Image}(X)$ について、
\begin{align*}
\Pr(X\in A) &= P\left(\{\omega\in\Omega\mid X(\omega)\in A\}\right)\\
&= P\left(\bigcup_{x\in A} \{\omega\in\Omega\mid X(\omega)=x\}\right)\\
&= \sum_{x\in A} P\left(\{\omega\in\Omega\mid X(\omega)=x\}\right)\\
&= \sum_{x\in A} \Pr\left(X=x\right)
\end{align*}

**確率質量関数 (probability mass function)**
\begin{align*}
f_X(x)&\coloneqq \Pr(X=x)\qquad\forall x\in\mathbb{R}.
\end{align*}

すると
\begin{align*}
\Pr(X\in A) &= \sum_{x\in A} f_X(x).
\end{align*}

```{python}
#| layout-ncol: 2
#| label: fig-binom
#| fig-cap:
#|  - "二項分布の確率質量関数"
#|  - "二項分布の累積分布関数"

import matplotlib.pyplot as plt
import numpy as np
from scipy.stats import binom

# パラメータの設定
n = 12       # 試行回数
p = 0.6      # 成功確率

# 取りうる値の範囲
x = np.arange(0, n+1)

# 二項分布のPMFの計算
pmf = binom.pmf(x, n, p)
cdf = binom.cdf(x, n, p)

# プロット
plt.figure(figsize=(4, 2))
plt.bar(x, pmf, tick_label=x)
plt.title(f'Pmf of binomial distribution with n={n}, p={p}')
plt.xlabel('$k$')
plt.ylabel('$\\Pr(X=k)$')
plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.show()

plt.figure(figsize=(4, 2))
plt.step(x, cdf, where='post')
plt.xticks(x)
plt.title(f'Cdf of binomial distribution with n={n}, p={p}')
plt.xlabel('$k$')
plt.ylabel('$\\Pr(X\\leq k)$')
plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.show()
```
  

## 連続型確率変数

**連続型確率変数**: 離散型確率変数でない確率変数


**確率密度関数 (probability density function)**
\begin{align*}
\Pr(X\in A) &= \int_{A} f_X(x) \mathrm{d}x.
\end{align*}

離散確率変数に対する
\begin{align*}
\Pr(X\in A) &= \sum_{x\in A} f_X(x)
\end{align*}

と同じ形。

一般的には確率密度関数は**存在するとは限らない**。

## 累積分布関数

\begin{align*}
F_X(x)&\coloneqq \Pr(X\le x).
\end{align*}

## 今週の課題

$\Omega = \{1,2,3,4,5,6\}$ とし、ある $P\colon\Omega\to\mathbb{R}_{\ge 0}$ について $(\Omega,\,P)$ を確率空間とする。
事象 $A,\,B,\,C$ を

\begin{align*}
A&=\left\{1,2,3,4\right\},&
B&=\left\{2,4,5\right\},&
C&=\left\{1,3,5,6\right\}
\end{align*}
とするとき、以下の問に答えよ

::: {.wide-list}

1. $A\cup B$,&nbsp; $A\cap B$,&nbsp; $A\setminus B$,&nbsp; $(A\cup B)\cap C$ をもとめよ。
1. $P(\{1,3\})$,&nbsp; $P(\{2,4\})$,&nbsp; $P(\{5\})$,&nbsp; $P(\{6\})$ を $P(A),\,P(B),\,P(C)$ を用いて表せ。

:::
