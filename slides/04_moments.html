<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="author" content="森 立平">
  <title>確率・統計基礎 – 確率論</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link rel="stylesheet" href="slides.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  </head><body class="quarto-light">$$
  \newcommand{\defiff}{\overset{\text{def}}{\iff}}
  \newcommand{\expt}[1]{\mathbb{E}\left[#1\right]}
  \newcommand{\var}[1]{\mathrm{Var}\left[#1\right]}
  \newcommand{\cov}[2]{\mathrm{Cov}\left[#1,\,#2\right]}
  $$


  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">確率論</h1>
  <p class="subtitle">期待値、分散、モーメント</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
森 立平 
</div>
</div>
</div>

</section>
<section id="期待値" class="slide level2">
<h2>期待値</h2>
<div id="def-exp" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (期待値)</strong></span> 離散型確率変数 <span class="math inline">\(X\)</span> の<strong>期待値</strong>は</p>
<p><span class="math display">\[\begin{align*}
\expt{X}
% &amp;= \sum_{\omega \in \Omega} X(\omega) P(\{\omega\})\\
%&amp;= \sum_{x\in \mathrm{Image}(X)} x P(\{\omega\mid X(\omega)=x\})\\
&amp;\coloneqq \sum_{x\in \mathrm{Image}(X)} x \Pr(X=x)\\
&amp;= \sum_{x\in \mathrm{Image}(X)} x f_X(x)
\end{align*}\]</span></p>
<p>と定義される。ここで、<strong>右辺の和が絶対収束しない場合は(適当な順番で和を取って収束したとしても)期待値は定義されない</strong>。</p>
<p>連続型確率変数 <span class="math inline">\(X\)</span> が確率密度関数 <span class="math inline">\(f_X\)</span> を持つとき、その<strong>期待値</strong>は</p>
<p><span class="math display">\[
\expt{X}\coloneqq \int_{-\infty}^\infty x f_X(x) \mathrm{d}x
\]</span></p>
<p>と定義される。 ただし、広義積分で上記の積分が存在する場合でも、 <span class="math display">\[
\int_{-\infty}^\infty |x| f_X(x) \mathrm{d}x
\]</span> が存在しない場合には期待値は定義されない。</p>
</div>
<p>連続型確率変数の期待値に関する様々な証明は<strong>ルベーグ積分の知識を必要とするのでこの授業では扱わない</strong>。 以下、証明はすべて<strong>離散確率変数の場合に限って</strong>与えて分かった気になることにする。</p>
</section>
<section id="確率変数の和の期待値" class="slide level2">
<h2>確率変数の和の期待値</h2>
<div id="lem-exp-sum" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 1</strong></span> 確率変数 <span class="math inline">\(X,\,Y\)</span> について <span class="math display">\[\begin{align*}
\expt{X+Y}&amp;=\expt{X}+\expt{Y}.
\end{align*}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[\begin{align*}
\expt{X+Y} &amp;= \sum_{z} z f_{X+Y}(z)\\
&amp;= \sum_{z} z \sum_x f_{X,\,Y}(x, z-x)\\
&amp;= \sum_{x,\,y} (x+y) f_{X,\,Y}(x, y)\qquad (y=z-x)\\
&amp;= \sum_{x,\,y} xf_{X,\,Y}(x,y) + \sum_{x,\,y} yf_{X,\,Y}(x,y)\\
&amp;= \sum_{x} xf_{X}(x) + \sum_{y} yf_{Y}(y)\\
&amp;= \expt{X} + \expt{Y}.
\end{align*}\]</span></p>
</div>
</section>
<section id="確率変数の積の期待値" class="slide level2">
<h2>確率変数の積の期待値</h2>
<div id="lem-exp-prod" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 2</strong></span> 確率変数 <span class="math inline">\(X\)</span> と <span class="math inline">\(Y\)</span> が<strong>独立</strong>のとき、 <span class="math display">\[\begin{align*}
\expt{XY}&amp;=\expt{X}\,\expt{Y}.
\end{align*}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[\begin{align*}
\expt{XY} &amp;= \sum_{z} z f_{XY}(z)\\
&amp;= \sum_{z} z \sum_{x\ne 0}f_{X,\,Y}(x,z/x)\\
&amp;= \sum_{z} z \sum_{x\ne 0}f_{X}(x)f_Y(z/x)\\
&amp;= \sum_{x\ne 0,\, y} xy f_{X}(x)f_Y(y)\qquad(y=z/x)\\
&amp;= \sum_{x,\, y} xy f_{X}(x)f_Y(y)\\
&amp;= \left(\sum_{x} xf_{X}(x)\right)\left(\sum_y yf_Y(y)\right)\\
&amp;= \expt{X}\,\expt{Y}
\end{align*}\]</span></p>
</div>
</section>
<section id="期待値の簡潔な表現" class="slide level2">
<h2>期待値の簡潔な表現</h2>
<div id="lem-lotus" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3 (Law of the unconscious statistician (LOTUS))</strong></span> 任意の関数 <span class="math inline">\(g\colon\mathbb{R}\to\mathbb{R}\)</span> について、</p>
<ol type="1">
<li><span class="math inline">\(X\)</span> が離散型確率変数のとき、 <span class="math display">\[\begin{align*}
\expt{g(X)} &amp;= \sum_{x} g(x) f_X(x).
\end{align*}\]</span></li>
<li><span class="math inline">\(X\)</span> が連続型確率変数で確率密度関数を持つとき、 <span class="math display">\[\begin{align*}
\expt{g(X)} &amp;= \int_{-\infty}^\infty g(x) f_X(x) \mathrm{d}x.
\end{align*}\]</span></li>
</ol>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math inline">\(X\)</span> を離散型確率変数とする。 <span class="math display">\[\begin{align*}
\expt{g(X)}
%&amp;= \sum_{x} x f_{g(X)}(x)\\
&amp;= \sum_{x} x \Pr(g(X) = x)
= \sum_{x} x P(\{\omega\in\Omega\mid g(X(\omega)) = x\})\\
&amp;= \sum_{x} x P\left(\bigcup_{y\in\mathrm{Image}(X)\colon\, g(y) = x}\{\omega\in\Omega\mid X(\omega) = y\}\right)\\
&amp;= \sum_{x}\sum_{y\in\mathrm{Image}(X)\colon\, g(y) = x} x P\left(\{\omega\in\Omega\mid X(\omega) = y\}\right)\\
&amp;= \sum_{y\in\mathrm{Image}(X)} g(y) f_X(y).
\end{align*}\]</span></p>
</div>
</section>
<section id="期待値の性質" class="slide level2">
<h2>期待値の性質</h2>
<div id="prp-exp" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1 (期待値の性質)</strong></span> 任意の確率変数 <span class="math inline">\(X\)</span> と <span class="math inline">\(a\in\mathbb{R}\)</span> について <span class="math display">\[\begin{align*}
\expt{X+a} &amp;= \expt{X}+a\\
\expt{aX} &amp;= a\expt{X}.
\end{align*}\]</span></p>
</div>
</section>
<section id="マルコフの不等式" class="slide level2">
<h2>マルコフの不等式</h2>
<div id="thm-markov" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (マルコフの不等式)</strong></span> 任意の<strong>非負</strong>確率変数 <span class="math inline">\(X\)</span> と <span class="math inline">\(a&gt;0\)</span> について <span class="math display">\[
\Pr(X\ge a)\le\frac{\expt{X}}{a}.
\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[\begin{align*}
\expt{X} &amp;= \sum_{x\in \mathrm{Image}(X)} f_X(x) x\\
&amp;= \sum_{\mathrm{Image}(X)\colon\, x\ge a} f_X(x) x + \sum_{\mathrm{Image}(X)\colon\, x &lt; a} f_X(x) x\\
&amp;\ge \sum_{\mathrm{Image}(X)\colon\, x\ge a} f_X(x) x\qquad\qquad (\Pr(X\ge 0)=1)\\
&amp;\ge \sum_{\mathrm{Image}(X)\colon\, x\ge a} f_X(x) a\\
&amp;= \Pr(X\ge a) a.
\end{align*}\]</span></p>
</div>
</section>
<section id="分散" class="slide level2">
<h2>分散</h2>
<div id="def-var" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 (分散)</strong></span> 確率変数 <span class="math inline">\(X\)</span> が期待値を持つとき、その<strong>分散</strong>を</p>
<p><span class="math display">\[
\var{X}\coloneqq  \expt{(X-\expt{X})^2}
\]</span></p>
<p>と定義する。 また、分散の平方根を<strong>標準偏差</strong>という。</p>
</div>
<p>確率変数 <span class="math inline">\(X\)</span> が分散を持つとき、</p>
<p><span class="math display">\[\begin{align*}
\var{X} &amp;= \expt{(X-\expt{X})^2}\\
&amp;= \expt{X^2-2X\expt{X}+\expt{X}^2}\\
&amp;= \expt{X^2}-2\expt{X}\expt{X}+\expt{X}^2\\
&amp;= \expt{X^2}-\expt{X}^2
\end{align*}\]</span></p>
<p>である。 分散は定義より非負の値を持つ。</p>
<div id="prp-var" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 2 (分散の性質)</strong></span> 任意の確率変数 <span class="math inline">\(X\)</span> と <span class="math inline">\(a\in\mathbb{R}\)</span> について <span class="math display">\[\begin{align*}
\var{X+a} &amp;= \var{X}\\
\var{aX} &amp;= a^2\var{X}.
\end{align*}\]</span></p>
</div>
<p>分散は直感的には期待値からのはずれ具合を表す値である。</p>
</section>
<section id="チェビシェフの不等式" class="slide level2">
<h2>チェビシェフの不等式</h2>
<div id="thm-chebyshev" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (チェビシェフの不等式)</strong></span> 任意の確率変数 <span class="math inline">\(X\)</span> と <span class="math inline">\(a&gt;0\)</span> について <span class="math display">\[
\Pr(|X-\expt{X}|\ge a)\le\frac{\var{X}}{a^2}.
\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[\begin{align*}
\Pr(|X-\expt{X}|\ge a)&amp;= \Pr((X-\expt{X})^2\ge a^2)\\
&amp;\le
\frac{\expt{(X-\expt{X})^2}}{a^2} = \frac{\var{X}}{a^2}.
\end{align*}\]</span></p>
</div>
</section>
<section id="互いに独立な確率変数の和" class="slide level2">
<h2>互いに独立な確率変数の和</h2>
<div id="lem-pairwise-var" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 4 (互いに独立な確率変数の和)</strong></span> 確率変数 <span class="math inline">\(X_1,\,X_2,\dotsc,X_n\)</span> が<strong>互いに独立</strong>のとき</p>
<p><span class="math display">\[\begin{align*}
\var{X_1+\dotsb+X_n} &amp;= \var{X_1} +\dotsb + \var{X_n}.
\end{align*}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[\begin{align*}
\var{X_1+\dotsb+X_n} &amp;= \expt{\left((X_1+\dotsb+X_n) - \expt{X_1+\dotsb+X_n}\right)^2}\\
&amp;= \expt{\left((X_1- \expt{X_1}) + \dotsb + (X_n-\expt{X_n})\right)^2}\\
&amp;= \expt{\sum_i (X_i- \expt{X_i})^2  + 2\sum_{i &lt; j}\left(X_i-\expt{X_i}\right)\left(X_j-\expt{X_j}\right)}\\
&amp;= \sum_i \expt{(X_i- \expt{X_i})^2} +  2\sum_{i &lt; j}\expt{\left(X_i-\expt{X_i}\right)\left(X_j-\expt{X_j}\right)}\\
&amp;= \sum_i \expt{(X_i- \expt{X_i})^2} +  2\sum_{i &lt; j}\expt{X_i-\expt{X_i}}\expt{X_j-\expt{X_j}}\\
&amp;= \sum_i \expt{(X_i- \expt{X_i})^2}
=\sum_i \var{X_i}.
\end{align*}\]</span></p>
</div>
</section>
<section id="確率変数の平均" class="slide level2">
<h2>確率変数の平均</h2>
<div id="exm-pairwise" class="theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> <strong>互いに独立</strong>な確率変数 <span class="math inline">\(X_1,\dotsc,X_n\)</span> のそれぞれが確率変数 <span class="math inline">\(X\)</span> と同分布であるとし、 <span class="math display">\[\begin{align*}
Y&amp;\coloneqq \frac1{n} (X_1+\dotsb+X_n)
\end{align*}\]</span> と定義する。 このとき、 <span class="math display">\[\begin{align*}
\expt{Y} &amp;= \expt{X}\\
\var{Y} &amp;= \frac1{n}\var{X}
\end{align*}\]</span> である。互いに独立な確率変数の平均を取ると期待値は変わらず、分散は小さくなる。</p>
<p>チェビシェフの不等式を適用すると、<span class="math inline">\(Y\)</span> は <span class="math inline">\(n\)</span> を大きくすると期待値周辺に集中していくことが分かる。</p>
</div>
</section>
<section id="共分散" class="slide level2">
<h2>共分散</h2>
<div id="def-exp" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3 (共分散)</strong></span> 確率変数 <span class="math inline">\(X,Y\)</span> が期待値を持つとき、その<strong>共分散</strong>を</p>
<p><span class="math display">\[\begin{align*}
\cov{X}{Y} &amp;\coloneqq \expt{(X-\expt{X})(Y-\expt{Y})}\\
&amp;= \expt{XY}-\expt{X}\,\expt{Y}
\end{align*}\]</span></p>
<p>と定義する。 共分散がゼロである確率変数のペアを<strong>無相関</strong>であるという。</p>
</div>
<p>定義より、<span class="math inline">\(\cov{X}{X}=\var{X}\)</span> であることが分かる。</p>
<div id="prp-ind-cov" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3</strong></span> 独立確率変数 <span class="math inline">\(X,Y\)</span> は無相関である。</p>
</div>
</section>
<section id="無相関だけど独立ではない例" class="slide level2">
<h2>無相関だけど独立ではない例</h2>
<p>逆に無相関であっても独立とは限らない。</p>
<div id="exm-ind-cov" class="theorem example">
<p><span class="theorem-title"><strong>Example 2</strong></span> 確率変数 <span class="math inline">\(X\)</span> を <span class="math display">\[\begin{align*}
f_X(0)= f_X(+1)= f_X(-1)= \frac13
\end{align*}\]</span> を満たすものとし、<span class="math inline">\(Y=X^2\)</span> とする。 このとき、 <span class="math display">\[\begin{align*}
\cov{X}{Y} &amp;= \expt{XY} - \expt{X}\expt{Y}\\
&amp;= \expt{X^3} - \expt{X}\expt{X^2}\\
&amp;= \expt{X} - \expt{X}\expt{X^2}\\
&amp;= \expt{X}(1-\expt{X^2})\\
&amp;= 0
\end{align*}\]</span> なので、<span class="math inline">\(X\)</span> と <span class="math inline">\(Y\)</span> は無相関である。 一方で <span class="math display">\[\begin{align*}
f_{Y}(0) &amp;= \frac13&amp;
f_{Y}(1) &amp;= \frac23\\
f_{X,\,Y}(0, 0) &amp;= \frac13&amp;
f_{X,\,Y}(1, 1) &amp;= \frac13&amp;
f_{X,\,Y}(-1, 1) &amp;= \frac13&amp;
\end{align*}\]</span> なので <span class="math inline">\(X\)</span> と <span class="math inline">\(Y\)</span> は独立ではない。</p>
</div>
</section>
<section id="共分散と分散の関係" class="slide level2">
<h2>共分散と分散の関係</h2>
<p>共分散は正の値も負の値も取り得る。 大雑把に言うと、</p>
<ul>
<li><span class="math inline">\(X\)</span> と <span class="math inline">\(Y\)</span> の共分散が正 <span class="math inline">\(\iff\)</span> <span class="math inline">\(X\)</span> が大きいとき <span class="math inline">\(Y\)</span> も大きい</li>
<li><span class="math inline">\(X\)</span> と <span class="math inline">\(Y\)</span> の共分散が負 <span class="math inline">\(\iff\)</span> <span class="math inline">\(X\)</span> が大きいとき <span class="math inline">\(Y\)</span> は小さい</li>
</ul>
<p>という意味になる。</p>
<div id="lem-var-sum" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 5</strong></span> 任意の確率変数 <span class="math inline">\(X_1,\dotsc,X_n\)</span> について <span class="math display">\[\begin{align*}
\var{\sum_i X_i} &amp;= \sum_i \var{X_i} + 2\sum_{i &lt; j} \cov{X_i}{X_j}.
\end{align*}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><a href="#/lem-pairwise-var" class="quarto-xref">Lemma&nbsp;4</a> の証明参照。</p>
</div>
</section>
<section id="モーメントとモーメント母関数" class="slide level2">
<h2>モーメントとモーメント母関数</h2>
<div id="def-moment" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4 (モーメント)</strong></span> 確率変数 <span class="math inline">\(X\)</span> と正の整数 <span class="math inline">\(n\ge 1\)</span> について、</p>
<p><span class="math display">\[
\mu_n(X)\coloneqq \expt{X^n}
\]</span></p>
<p>を <span class="math inline">\(X\)</span> の <span class="math inline">\(n\)</span> 次モーメントという。</p>
</div>
<div id="def-mg" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5 (モーメント母関数(積率母関数))</strong></span> 確率変数 <span class="math inline">\(X\)</span> について、</p>
<p><span class="math display">\[
M_X(t) \coloneqq \expt{\mathrm{e}^{tX}}\qquad t\in\mathbb{R}
\]</span></p>
<p>を <span class="math inline">\(X\)</span> の<strong>モーメント母関数</strong>という。 すべての <span class="math inline">\(t\in\mathbb{R}\)</span> で <span class="math inline">\(M_X(t)\)</span> が存在しない場合もある。 また、</p>
<p><span class="math display">\[
K_X(t) \coloneqq \log M_X(t)
\]</span> を <span class="math inline">\(X\)</span> の<strong>キュムラント母関数</strong>という。</p>
</div>
<p><br></p>
<p>定義より、<span class="math inline">\(M_X(0) = 1\)</span>, <span class="math inline">\(K_X(0)=0\)</span> である。</p>
<p>また、<strong>独立</strong>確率変数 <span class="math inline">\(X,\,Y\)</span> について <span class="math display">\[\begin{align*}
M_{X+Y}(t) &amp;= \expt{\mathrm{e}^{t(X+Y)}} = \expt{\mathrm{e}^{tX}\cdot\mathrm{e}^{tY}}
= \expt{\mathrm{e}^{tX}}\cdot\expt{\mathrm{e}^{tY}} = M_X(t)M_Y(t)
\end{align*}\]</span> である。同様に <span class="math inline">\(K_{X+Y}(t) = K_X(t) + K_Y(t)\)</span> である。</p>
</section>
<section id="モーメントの母関数" class="slide level2">
<h2>モーメントの母関数</h2>
<div id="thm-moment" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3</strong></span> 確率変数 <span class="math inline">\(X\)</span> について、ある <span class="math inline">\(\epsilon &gt;0\)</span> が存在し、モーメント母関数 <span class="math inline">\(M_X(t)\)</span> が <strong><span class="math inline">\(t\in(-\epsilon,\epsilon)\)</span> で存在するとき</strong>、</p>
<p><span class="math display">\[\begin{align*}
M_X(t) &amp;=\sum_{n\ge 0}\frac{\expt{X^n}}{n!}t^n\qquad\forall t\in(-\epsilon,\epsilon)\\
\mu_n(X) &amp;= \left.\frac{\mathrm{d}^n M_X(t)}{\mathrm{d} t^n}\right|_{t=0}.
\end{align*}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>前半の証明を与える。 離散型確率変数 <span class="math inline">\(X\)</span> について、 <span class="math display">\[\begin{align*}
M_X(t) &amp;= \expt{\mathrm{e}^{tX}}
= \sum_x \mathrm{e}^{tx} f_X(x)
= \sum_x \left(\sum_{n\ge0}\frac{(tx)^n}{n!}\right) f_X(x)
\end{align*}\]</span> である。 ここで、任意の <span class="math inline">\(t\in(-\epsilon,\epsilon)\)</span> について <span class="math display">\[\begin{align*}
\sum_x \sum_{n\ge0}\left|\frac{(tx)^n}{n!} f_X(x)\right|
&amp;= \sum_x \sum_{n\ge0}\frac{|tx|^n}{n!} f_X(x)
= \sum_x \mathrm{e}^{|tx|} f_X(x)
\le \sum_x (\mathrm{e}^{tx}+\mathrm{e}^{-tx}) f_X(x)\\
&amp;= \expt{\mathrm{e}^{tX}} + \expt{\mathrm{e}^{-tX}}
= M_X(t) + M_X(-t) &lt; \infty
\end{align*}\]</span> よって、この無限和は任意の <span class="math inline">\(t\in(-\epsilon,\epsilon)\)</span> について<strong>絶対収束する</strong>。 そのため、和の順序を変えても収束値は変化しない。 <span class="math display">\[\begin{align*}
M_X(t) &amp;=
\sum_x \left(\sum_{n\ge0}\frac{(tx)^n}{n!}\right) f_X(x)
= \sum_{n\ge 0} \sum_{x}\frac{(tx)^n}{n!}f_X(x)
= \sum_{n\ge 0} \frac{\sum_xx^n f_X(x)}{n!}t^n
= \sum_{n\ge 0} \frac{\expt{X^n}}{n!}t^n\qquad\forall t\in(-\epsilon,\epsilon).
\end{align*}\]</span> <!--
(概要)
\begin{align*}
M_X(t) &= \expt{\mathrm{e}^{tX}}\\
&=\expt{\sum_{n\ge 0}\frac{(tX)^n}{n!}}\\
&=\sum_{n\ge 0}\expt{\frac{(tX)^n}{n!}}\qquad\text{\textsf{(この無限和と期待値の交換が定理の条件より正当化される)}}.
\end{align*}
--></p>
</div>
</section>
<section id="キュムラント母関数" class="slide level2">
<h2>キュムラント母関数</h2>
<div id="cor-cumulant" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 1</strong></span> 確率変数 <span class="math inline">\(X\)</span> について、ある <span class="math inline">\(\epsilon &gt;0\)</span> が存在し、モーメント母関数 <span class="math inline">\(M_X(t)\)</span> が <strong><span class="math inline">\(t\in(-\epsilon,\epsilon)\)</span> で存在するとき</strong>、</p>
<p><span class="math display">\[\begin{align*}
\left.\frac{\mathrm{d} K_X(t)}{\mathrm{d} t}\right|_{t=0} &amp;= \expt{X},&amp;
\left.\frac{\mathrm{d}^2 K_X(t)}{\mathrm{d} t^2}\right|_{t=0} &amp;=  \var{X}.
\end{align*}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[\begin{align*}
\left.\frac{\mathrm{d} K_X(t)}{\mathrm{d} t}\right|_{t=0} &amp;= \left.\frac{M'_X(t)}{M_X(t)}\right|_{t=0}=\expt{X}\\
\left.\frac{\mathrm{d}^2 K_X(t)}{\mathrm{d} t^2}\right|_{t=0} &amp;= \left.\frac{M''_X(t)M_X(t) - M'_X(t)^2}{M_X(t)^2}\right|_{t=0} = M''_X(0) - M'_X(0)^2 = \var{X}.
\end{align*}\]</span></p>
</div>
<p>また、重要度は低くなるが、</p>
<p><span class="math display">\[\begin{align*}
\left.\frac{\mathrm{d}^3 K_X(t)}{\mathrm{d} t^3}\right|_{t=0} &amp;= \expt{(X - \expt{X})^3}\\
\left.\frac{\mathrm{d}^4 K_X(t)}{\mathrm{d} t^4}\right|_{t=0} &amp;= \expt{(X - \expt{X})^4} - 3\var{X}^2
\end{align*}\]</span></p>
<p>が成り立つ(覚えなくてよい)。 一般に以下を <span class="math inline">\(X\)</span> の <strong><span class="math inline">\(n\)</span> 次キュムラント</strong> と呼ぶ。 <span class="math display">\[\begin{align*}
\kappa_n(X) &amp;\coloneqq \left.\frac{\mathrm{d}^n K_X(t)}{\mathrm{d} t^n}\right|_{t=0}.
\end{align*}\]</span></p>
</section>
<section id="モーメント母関数の一致" class="slide level2">
<h2>モーメント母関数の一致</h2>
<div id="thm-moment" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4</strong></span> 確率変数 <span class="math inline">\(X\)</span> と <span class="math inline">\(Y\)</span> のモーメント母関数が0を含む開区間 <span class="math inline">\((-\epsilon,\,\epsilon)\)</span> で存在し、それらが等しいとき、<span class="math inline">\(X\)</span> の分布と <span class="math inline">\(Y\)</span> の分布は等しい。</p>
</div>
<p>証明は確率変数の像が有限の場合に与える(ウェブ資料参照)。</p>
<!--
::: {.proof}
$\mathrm{Image}(X)$ と $\mathrm{Image}(Y)$ が有限の場合に限って証明を与える
(この場合はモーメント母関数は $\mathbb{R}$ 全体で存在するのだが)。
\begin{align*}
\{x_0,\dotsc,x_{N-1}\} &\coloneqq \mathrm{Image}(X) \cup \mathrm{Image}(Y)
\end{align*}
とする。
\begin{align*}
M_X(t) &= \sum_{k=0}^{N-1} f_X(x_k) \mathrm{e}^{tx_k},&
M_Y(t) &= \sum_{k=0}^{N-1} f_Y(x_k) \mathrm{e}^{tx_k}
\end{align*}
なので、
\begin{align*}
0 = M_X(t) - M_Y(t) &= \sum_{k=0}^{N-1} (f_X(x_k)-f_Y(x_k)) \mathrm{e}^{tx_k}\qquad\forall t\in(-\epsilon,\epsilon)
\end{align*}
各 $k\in\{0,1,\dotsc,N-1\}$ について、$t_k\coloneqq \epsilon\frac{k}{N}$ とおくと、
\begin{align}
\sum_{k=0}^{N-1} (f_X(x_k)-f_Y(x_k)) \mathrm{e}^{t_\ell x_k}&=0\qquad\forall \ell\in\{0,1,\dotsc,N-1\}
\end{align}
である。
ここで、$N\times N$ 実行列 $V$ を
\begin{align*}
V_{\ell k} &= \mathrm{e}^{t_\ell x_k}
= \mathrm{e}^{\frac{\epsilon x_k}{N} \ell}\qquad\forall k,\ell\in\{0,1,\dotsc,N-1\}
\end{align*}
とおく。
この行列 $V$ は Vandermonde行列の転置であり正則なので、
\begin{align*}
&\sum_{k=0}^{N-1} V_{\ell k} g_k=0\qquad\forall \ell\in\{0,1,\dotsc,N-1\}\\
\implies& g_k = 0 \qquad\forall k\in\{0,1,\dotsc,N-1\}
\end{align*}
よって、
\begin{align*}
f_X(x_k) &= f_Y(x_k) \qquad\forall k\in\{0,1,\dotsc,N-1\}
\end{align*}
である。
:::
-->
<p><a href="#/thm-moment" class="quarto-xref">Theorem&nbsp;4</a> より、モーメント母関数には確率変数の分布のすべての情報が含まれていると言える。 ただし、モーメント母関数は原点まわりで存在しないこともあるので、分布の情報をすべて含む関数としては<strong>特性関数</strong> <span class="math display">\[\begin{align*}
\varphi_X(t) &amp;\coloneqq \expt{\mathrm{e}^{itX}}\qquad\forall t\in\mathbb{R}
\end{align*}\]</span> の方が優秀である。 特性関数は常に存在する。 一方でモーメント母関数は確率の集中を示す文脈では中心的な役割を果たす。</p>
</section>
<section id="今週の課題" class="slide level2">
<h2>今週の課題</h2>
<p><span class="math inline">\(\lambda&gt;0\)</span> について <span class="math inline">\(X\sim\mathrm{Poisson}(\lambda)\)</span> とする。 以下の問に答えよ</p>
<div class="wide-list">
<ol type="1">
<li><span class="math inline">\(X\)</span> のキュムラント母関数をもとめよ。</li>
<li><span class="math inline">\(\expt{X}\)</span> と <span class="math inline">\(\var{X}\)</span> をもとめよ。</li>
</ol>
</div>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/Prob-Stat\.github\.io\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>