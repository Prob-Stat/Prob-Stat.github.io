<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.27">

  <meta name="author" content="森 立平">
  <title>確率・統計基礎 – 確率論</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link rel="stylesheet" href="slides.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  </head><body class="quarto-light">$$
  \newcommand{\defiff}{\overset{\text{def}}{\iff}}
  \newcommand{\expt}[1]{\mathbb{E}\left[#1\right]}
  \newcommand{\var}[1]{\mathrm{Var}\left[#1\right]}
  \newcommand{\cov}[2]{\mathrm{Cov}\left[#1,\,#2\right]}
  $$


  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">確率論</h1>
  <p class="subtitle">定常分布</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
森 立平 
</div>
</div>
</div>

</section>
<section id="スペクトル半径-12" class="slide level2">
<h2>スペクトル半径 1/2</h2>
<div id="def-spectral" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (スペクトル半径)</strong></span> 正方行列 <span class="math inline">\(A\in\mathbb{C}^{n\times n}\)</span> について、その固有値の絶対値の最大値を<strong>スペクトル半径</strong>といい <span class="math inline">\(\rho(A)\)</span> で表す 。</p>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Caution</strong></p>
</div>
<div class="callout-content">
<p><strong>スペクトルノルム</strong>はスペクトル半径と似た概念であるが異なるものである。 正方行列とは限らない行列 <span class="math inline">\(A\in\mathbb{C}^{n\times m}\)</span> のスペクトルノルムは <span class="math display">\[\begin{align*}
\|A\|_2&amp;\coloneqq \max_{x\in\mathbb{C}^m \setminus\{0\}} \frac{\|Ax\|_2}{\|x\|_2}
\end{align*}\]</span> と定義される。 ここで、右辺の <span class="math inline">\(\|\cdot\|_2\)</span> は複素ユークリッド空間上の <strong><span class="math inline">\(L_2\)</span> ノルム</strong>を表す。ここで、 <span class="math display">\[\begin{align*}
\|A\|_2&amp;=
\max_{x\in\mathbb{C}^m \setminus\{0\}} \left\|A\frac{x}{\|x\|_2}\right\|_2\\
&amp;=\max_{x\in\mathbb{C}^m\colon\, \|x\|_2=1} \left\|Ax\right\|_2\\
&amp;=\max_{x\in\mathbb{C}^m\colon\, \|x\|_2=1} \sqrt{\left\|Ax\right\|_2^2}\\
&amp;=\sqrt{\max_{x\in\mathbb{C}^m\colon\, \|x\|_2=1} x^*A^*Ax}\\
&amp;=\sqrt{\lambda_{\max}(A^*A)}\\
&amp;=\sigma_{\max}(A)
\end{align*}\]</span> である。<span class="math inline">\(\lambda_{\max}\)</span> と <span class="math inline">\(\sigma_{\max}\)</span> は最大固有値と最大特異値を表す。</p>
</div>
</div>
</div>
</section>
<section id="スペクトル半径-22" class="slide level2">
<h2>スペクトル半径 2/2</h2>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Caution</strong></p>
</div>
<div class="callout-content">
<p>直感的な意味としては</p>
<ul>
<li>スペクトルノルム<span class="math inline">\(\colon\)</span> 線形写像 <span class="math inline">\(A\)</span> が <span class="math inline">\(L_2\)</span> ノルムをどれだけ大きくするか？</li>
<li>スペクトル半径 <span class="math inline">\(\colon\)</span> 線形写像 <span class="math inline">\(A\)</span> が<strong>向きを変えずに</strong> <span class="math inline">\(L_2\)</span> ノルムをどれだけ大きくするか？</li>
</ul>
<p>ということになる。 これらの意味から <span class="math inline">\(\|A\|_2\ge\rho(A)\)</span> であることが分かる。 実際 <span class="math inline">\(\|A\|_2\)</span> の定義の中で <span class="math inline">\(x\)</span> として <span class="math inline">\(A\)</span> の絶対値最大固有値に対応する固有ベクトルを選べばこの不等式が得られる。</p>
<p>正方行列 <span class="math inline">\(A\in\mathbb{C}^{n\times n}\)</span> が<strong>正規行列</strong>のとき、スペクトル分解定理よりユニタリ行列 <span class="math inline">\(U\)</span> と対角行列 <span class="math inline">\(D\)</span> を用いて <span class="math inline">\(A = UDU^*\)</span> と表せる。 このとき、<span class="math inline">\(A^*A=UD^*DU^*\)</span> であることから、簡単な計算により <span class="math inline">\(\|A\|_2=\rho(A)\)</span> であることが分かる。</p>
<p>しかし一般的には(対角化可能であっても)スペクトル半径とスペクトルノルムは異なる。 例えば、 <span class="math display">\[\begin{align*}
A&amp;=\begin{bmatrix}
1&amp;0\\
1&amp;0
\end{bmatrix}
\end{align*}\]</span> とすると、 <span class="math inline">\(A\)</span> の固有値は 0 と 1 なので<span class="math inline">\(\rho(A)=1\)</span> である。 一方で、 <span class="math display">\[\begin{align*}
A^*A&amp;=
\begin{bmatrix}
2&amp;0\\
0&amp;0
\end{bmatrix}
\end{align*}\]</span> より、<span class="math inline">\(A^*A\)</span> の固有値は 0 と 2 である。 よって、<span class="math inline">\(A\)</span> のスペクトルノルムは <span class="math inline">\(\|A\|_2=\sqrt{2} &gt; 1 =\rho(A)\)</span> である。 ここで、<span class="math inline">\(A\)</span> は確率行列であり、二つの異なる固有値を持つので対角化可能である。 また、スペクトル半径はノルムにもならない。 <span class="math display">\[\begin{align*}
\rho\left(\begin{bmatrix}0&amp;1\\0&amp;0\end{bmatrix}\right) &amp;= 0
\end{align*}\]</span> であるし、 <span class="math display">\[\begin{align*}
1&amp;=\rho\left(\begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix}\right) &gt;
\rho\left(\begin{bmatrix}0&amp;1\\0&amp;0\end{bmatrix}\right) +
\rho\left(\begin{bmatrix}0&amp;0\\1&amp;0\end{bmatrix}\right) = 0
\end{align*}\]</span> なので三角不等式も満たさない。</p>
</div>
</div>
</div>
<div id="lem-spectral" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 1</strong></span> 任意の確率行列 <span class="math inline">\(T\)</span> について、<span class="math inline">\(\rho(T)=1\)</span> である。</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>すべての成分が1の列ベクトルは確率行列 <span class="math inline">\(T\)</span> の固有値1に対する右固有ベクトルになるので、<span class="math inline">\(\rho(T)\ge 1\)</span> である。</p>
<p>以下では <span class="math inline">\(\rho(T)\le 1\)</span> を示す。 遷移行列 <span class="math inline">\(T\)</span> の固有値 <span class="math inline">\(\lambda\in\mathbb{C}\)</span> に対応する固有ベクトルを <span class="math inline">\(v\)</span> とすると <span class="math display">\[\begin{align*}
Tv &amp;= \lambda v
\end{align*}\]</span> が成り立つ。 <span class="math inline">\(v\)</span> の成分で絶対値最大のものを第 <span class="math inline">\(i\)</span> 成分とする。 第 <span class="math inline">\(i\)</span> 成分に注目すると <span class="math display">\[\begin{align*}
\sum_{j\in S}T_{i,j}v_j &amp;= \lambda v_i
\end{align*}\]</span> が成り立つ。ここで <span class="math display">\[\begin{align*}
|\lambda| |v_i| &amp;= \left|\sum_{j\in S}T_{i,j}v_j\right|\\
&amp;\le \sum_{j\in S}T_{i,j}\left|v_j\right|\\
&amp;\le \sum_{j\in S}T_{i,j}\left|v_i\right|\\
&amp;=\left|v_i\right|
\end{align*}\]</span> と <span class="math inline">\(|v_i|&gt;0\)</span> より、 <span class="math inline">\(|\lambda|\le 1\)</span> である。</p>
</div>
</section>
<section id="確率行列のスペクトル半径" class="slide level2">
<h2>確率行列のスペクトル半径</h2>
<div id="lem-spectral" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 2</strong></span> 任意の確率行列 <span class="math inline">\(T\)</span> について、<span class="math inline">\(\rho(T)=1\)</span> である。</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>すべての成分が1の列ベクトルは確率行列 <span class="math inline">\(T\)</span> の固有値1に対する右固有ベクトルになるので、<span class="math inline">\(\rho(T)\ge 1\)</span> である。</p>
<p>以下では <span class="math inline">\(\rho(T)\le 1\)</span> を示す。 遷移行列 <span class="math inline">\(T\)</span> の固有値 <span class="math inline">\(\lambda\in\mathbb{C}\)</span> に対応する固有ベクトルを <span class="math inline">\(v\)</span> とすると <span class="math display">\[\begin{align*}
Tv &amp;= \lambda v
\end{align*}\]</span> が成り立つ。 <span class="math inline">\(v\)</span> の成分で絶対値最大のものを第 <span class="math inline">\(i\)</span> 成分とする。 第 <span class="math inline">\(i\)</span> 成分に注目すると <span class="math display">\[\begin{align*}
\sum_{j\in S}T_{i,j}v_j &amp;= \lambda v_i
\end{align*}\]</span> が成り立つ。ここで <span class="math display">\[\begin{align*}
|\lambda| |v_i| &amp;= \left|\sum_{j\in S}T_{i,j}v_j\right|\\
&amp;\le \sum_{j\in S}T_{i,j}\left|v_j\right|\\
&amp;\le \sum_{j\in S}T_{i,j}\left|v_i\right|\\
&amp;=\left|v_i\right|
\end{align*}\]</span> と <span class="math inline">\(|v_i|&gt;0\)</span> より、 <span class="math inline">\(|\lambda|\le 1\)</span> である。</p>
</div>
</section>
<section id="定常分布" class="slide level2">
<h2>定常分布</h2>
<p>マルコフ連鎖の推移行列 <span class="math inline">\(T\)</span> について、 <span class="math display">\[\begin{align*}
\mu T &amp;= \mu
\end{align*}\]</span> を満たす確率ベクトル(非負で成分の和が1) <span class="math inline">\(\mu\)</span> を<strong>定常分布</strong>と呼ぶのであった。 今回は<strong>定常分布の存在と唯一性</strong>について考える。</p>
<div id="def-digraph" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 (有向グラフ)</strong></span> 有限集合 <span class="math inline">\(V\)</span> と集合 <span class="math inline">\(E\subseteq V\times V\)</span> のペア <span class="math inline">\(G=(V,\,E)\)</span> を有向グラフという。 <span class="math inline">\(V\)</span> の元を<strong>頂点</strong>、<span class="math inline">\(E\)</span> の元を<strong>辺(有向辺)</strong>と呼ぶ。</p>
</div>
<p>有向辺 <span class="math inline">\((u,v)\in E\)</span> は頂点 <span class="math inline">\(u\)</span> から頂点 <span class="math inline">\(v\)</span> への有向辺と解釈することにする。</p>
<div class="cell" data-fig-width="7" data-fig-height="3" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="672" height="288" viewbox="0.00 0.00 297.02 173.25" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169.25)">
<title>irreduc_graph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-169.25 293.02,-169.25 293.02,4 -4,4"></polygon>
<!-- 1 -->
<g id="node1" class="node">
<title>1</title>
<ellipse fill="none" stroke="black" cx="22.63" cy="-82.63" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="22.63" y="-76.63" font-family="Times,serif" font-size="20.00">1</text>
</g>
<!-- 2 -->
<g id="node2" class="node">
<title>2</title>
<ellipse fill="none" stroke="black" cx="103.88" cy="-82.63" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="103.88" y="-76.63" font-family="Times,serif" font-size="20.00">2</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge1" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M45.28,-82.63C53.23,-82.63 62.41,-82.63 71.07,-82.63"></path>
<polygon fill="black" stroke="black" points="71.25,-86.13 81.25,-82.63 71.25,-79.13 71.25,-86.13"></polygon>
</g>
<!-- 3 -->
<g id="node3" class="node">
<title>3</title>
<ellipse fill="none" stroke="black" cx="185.14" cy="-142.63" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="185.14" y="-136.63" font-family="Times,serif" font-size="20.00">3</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge2" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M122.47,-95.94C133.04,-103.94 146.68,-114.27 158.44,-123.17"></path>
<polygon fill="black" stroke="black" points="156.51,-126.1 166.6,-129.35 160.74,-120.52 156.51,-126.1"></polygon>
</g>
<!-- 4 -->
<g id="node4" class="node">
<title>4</title>
<ellipse fill="none" stroke="black" cx="266.39" cy="-82.63" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="266.39" y="-76.63" font-family="Times,serif" font-size="20.00">4</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge3" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M126.2,-77.87C153.86,-75.48 202.33,-75.24 234.15,-77.15"></path>
<polygon fill="black" stroke="black" points="234.02,-80.65 244.24,-77.88 234.52,-73.67 234.02,-80.65"></polygon>
</g>
<!-- 5 -->
<g id="node5" class="node">
<title>5</title>
<ellipse fill="none" stroke="black" cx="185.14" cy="-22.63" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="185.14" y="-16.63" font-family="Times,serif" font-size="20.00">5</text>
</g>
<!-- 2&#45;&gt;5 -->
<g id="edge7" class="edge">
<title>2-&gt;5</title>
<path fill="none" stroke="black" d="M122.47,-69.31C133.04,-61.31 146.68,-50.99 158.44,-42.08"></path>
<polygon fill="black" stroke="black" points="160.74,-44.73 166.6,-35.91 156.51,-39.15 160.74,-44.73"></polygon>
</g>
<!-- 3&#45;&gt;1 -->
<g id="edge4" class="edge">
<title>3-&gt;1</title>
<path fill="none" stroke="black" d="M162.76,-138.39C141.6,-133.83 108.52,-125.72 81.25,-114.63 71,-110.46 60.26,-104.87 50.88,-99.53"></path>
<polygon fill="black" stroke="black" points="52.41,-96.37 42.01,-94.33 48.87,-102.41 52.41,-96.37"></polygon>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge5" class="edge">
<title>3-&gt;4</title>
<path fill="none" stroke="black" d="M203.73,-129.31C214.29,-121.31 227.93,-110.99 239.69,-102.08"></path>
<polygon fill="black" stroke="black" points="241.99,-104.73 247.85,-95.91 237.77,-99.15 241.99,-104.73"></polygon>
</g>
<!-- 4&#45;&gt;2 -->
<g id="edge6" class="edge">
<title>4-&gt;2</title>
<path fill="none" stroke="black" d="M244.24,-87.37C216.67,-89.77 168.21,-90.02 136.32,-88.11"></path>
<polygon fill="black" stroke="black" points="136.42,-84.61 126.2,-87.39 135.92,-91.6 136.42,-84.61"></polygon>
</g>
<!-- 4&#45;&gt;4 -->
<g id="edge9" class="edge">
<title>4-&gt;4</title>
<path fill="none" stroke="black" d="M252.58,-100.59C248.97,-112.14 253.58,-123.25 266.39,-123.25 275.2,-123.25 280.13,-118 281.18,-110.96"></path>
<polygon fill="black" stroke="black" points="284.62,-110.22 280.21,-100.59 277.66,-110.87 284.62,-110.22"></polygon>
</g>
<!-- 5&#45;&gt;1 -->
<g id="edge8" class="edge">
<title>5-&gt;1</title>
<path fill="none" stroke="black" d="M162.76,-26.86C141.6,-31.42 108.52,-39.54 81.25,-50.63 71,-54.8 60.26,-60.39 50.88,-65.73"></path>
<polygon fill="black" stroke="black" points="48.87,-62.85 42.01,-70.92 52.41,-68.89 48.87,-62.85"></polygon>
</g>
</g>
</svg>
</div>
<p></p><figcaption> 有向グラフ <span class="math inline">\(G=(V=\{1,2,3,4,5\},\, E=\{(1,2),\,(2,3),(2,4),\,(2,5),\,(3,1),\,(3,4),\,(4,2),\,(4,4),\,(5,1)\})\)</span></figcaption> </figure><p></p>
</div>
</div>
</div>
</section>
<section id="遷移グラフ" class="slide level2">
<h2>遷移グラフ</h2>
<div id="def-trgraph" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3 (遷移グラフ)</strong></span> 有向グラフ <span class="math inline">\(G=(V,\,E)\)</span> が状態集合 <span class="math inline">\(S\)</span> 上のマルコフ連鎖の遷移行列 <span class="math inline">\(T\)</span> の<strong>遷移グラフ</strong> <span class="math inline">\(\defiff\)</span> <span class="math display">\[\begin{align*}
V&amp;= S\\
E&amp;=\left\{(u,v)\in V\times V\mid T_{u,v}&gt;0\right\}.
\end{align*}\]</span></p>
</div>
<p>マルコフ連鎖の定常分布や収束に関する議論をする際には遷移確率は 0 か正かということが問題になり、具体的な値は問題にならない。 したがって、定常分布が唯一であるための条件などは遷移グラフの性質として表すことができる。</p>
<div id="def-cycle" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4 (有向グラフのウォーク)</strong></span> 有向グラフ <span class="math inline">\(G=(V,E)\)</span> の頂点列 <span class="math display">\[\begin{align*}
(v_0,v_1,\dotsc,v_\ell)
\end{align*}\]</span> で各 <span class="math inline">\(i=0,1,\dotsc,\ell-1\)</span> について <span class="math inline">\((v_i,\,v_{i+1})\in E\)</span> を満たすものを<strong>(<span class="math inline">\(v_0\)</span> から <span class="math inline">\(v_{\ell}\)</span> への)ウォーク</strong>という。 また、<span class="math inline">\(\ell\)</span> をウォークの<strong>長さ</strong>という。</p>
</div>
<p>頂点列 <span class="math inline">\((v)\)</span> は長さ0のウォークであることに気をつけよう。 遷移グラフの定義より、任意の <span class="math inline">\(u,v\in S\)</span> について <span class="math display">\[\begin{align*}
&amp;\text{遷移グラフ上に $u$ から $v$ への長さ $\ell$ のウォークが存在する} \iff (T^\ell)_{u,v} &gt; 0\\
\iff&amp;\Pr(X_\ell=v\mid X_0=u) &gt; 0
\end{align*}\]</span> である。</p>
</section>
<section id="既約性と定常分布" class="slide level2">
<h2>既約性と定常分布</h2>
<div id="def-equiv" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5 (順序関係)</strong></span> 推移行列 <span class="math inline">\(T\)</span> を持つマルコフ連鎖の状態 <span class="math inline">\(u,v\in S\)</span> について <span class="math inline">\(u\le_T v\)</span> <span class="math inline">\(\defiff\)</span> その遷移グラフにおいて <span class="math inline">\(u\)</span> から <span class="math inline">\(v\)</span> へのウォークが存在する。 また、<span class="math inline">\(u\le_T v\)</span> かつ <span class="math inline">\(v\le_T u\)</span> のとき、<span class="math inline">\(u\sim_T v\)</span> とする。</p>
</div>
<p>この <span class="math inline">\(\le_T\)</span> は以下の<strong>前順序関係</strong>の公理を満たす。</p>
<ul>
<li>(反射律) <span class="math inline">\(\forall u\in S,\, u\le_T u\)</span>.</li>
<li>(推移律) <span class="math inline">\(\forall u,v,w\in S,\, (u\le_T v\,\land\, v\le_T w) \implies u\le_T w\)</span>.</li>
</ul>
<p>また、<span class="math inline">\(\sim_T\)</span> は以下の<strong>同値関係</strong>の公理を満たす。</p>
<ul>
<li>(反射律) <span class="math inline">\(\forall u\in S,\, u\sim_T u\)</span>.</li>
<li>(対称律) <span class="math inline">\(\forall u,v\in S,\, u\sim_T v\implies v\sim_T u\)</span>.</li>
<li>(推移律) <span class="math inline">\(\forall u,v,w\in S,\, (u\sim_T v\,\land\, v\sim_T w) \implies u\sim_T w\)</span>.</li>
</ul>
<div id="def-irred" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6 (マルコフ連鎖の既約性)</strong></span> マルコフ連鎖が<strong>既約</strong>である <span class="math inline">\(\defiff\)</span> 任意の <span class="math inline">\(u,v\in S\)</span> について <span class="math inline">\(u\sim_T v\)</span>. <!--
任意の $x,y\in S$ についてある $t\in\mathbb{Z}_{\ge 0}$ が存在して、
\begin{align*}
\Pr(X_t=y\mid X_0 = x)&>0
\end{align*}
$\iff$
任意の $x,y\in S$ についてある $t\in\mathbb{Z}_{\ge 0}$ が存在して、$(T^t)_{x,y}>0$.
--></p>
</div>
<p>有向グラフ <span class="math inline">\(G\)</span> の任意の頂点 <span class="math inline">\(u, v\in V\)</span> について <span class="math inline">\(u\)</span> から <span class="math inline">\(v\)</span> へのウォークが存在するとき、<span class="math inline">\(G\)</span> は<strong>強連結</strong>であるという。 よってマルコフ連鎖が既約 <span class="math inline">\(\iff\)</span> 遷移グラフが強連結である。</p>
<div class="cell" data-fig-width="5" data-fig-height="1.2" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="480" height="115" viewbox="0.00 0.00 297.02 173.25" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169.25)">
<title>irreduc_graph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-169.25 293.02,-169.25 293.02,4 -4,4"></polygon>
<!-- 1 -->
<g id="node1" class="node">
<title>1</title>
<ellipse fill="none" stroke="black" cx="22.63" cy="-82.63" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="22.63" y="-76.63" font-family="Times,serif" font-size="20.00">1</text>
</g>
<!-- 2 -->
<g id="node2" class="node">
<title>2</title>
<ellipse fill="none" stroke="black" cx="103.88" cy="-82.63" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="103.88" y="-76.63" font-family="Times,serif" font-size="20.00">2</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge1" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M45.28,-82.63C53.23,-82.63 62.41,-82.63 71.07,-82.63"></path>
<polygon fill="black" stroke="black" points="71.25,-86.13 81.25,-82.63 71.25,-79.13 71.25,-86.13"></polygon>
</g>
<!-- 3 -->
<g id="node3" class="node">
<title>3</title>
<ellipse fill="none" stroke="black" cx="185.14" cy="-142.63" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="185.14" y="-136.63" font-family="Times,serif" font-size="20.00">3</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge2" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M122.47,-95.94C133.04,-103.94 146.68,-114.27 158.44,-123.17"></path>
<polygon fill="black" stroke="black" points="156.51,-126.1 166.6,-129.35 160.74,-120.52 156.51,-126.1"></polygon>
</g>
<!-- 4 -->
<g id="node4" class="node">
<title>4</title>
<ellipse fill="none" stroke="black" cx="266.39" cy="-82.63" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="266.39" y="-76.63" font-family="Times,serif" font-size="20.00">4</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge3" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M126.2,-77.87C153.86,-75.48 202.33,-75.24 234.15,-77.15"></path>
<polygon fill="black" stroke="black" points="234.02,-80.65 244.24,-77.88 234.52,-73.67 234.02,-80.65"></polygon>
</g>
<!-- 5 -->
<g id="node5" class="node">
<title>5</title>
<ellipse fill="none" stroke="black" cx="185.14" cy="-22.63" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="185.14" y="-16.63" font-family="Times,serif" font-size="20.00">5</text>
</g>
<!-- 2&#45;&gt;5 -->
<g id="edge7" class="edge">
<title>2-&gt;5</title>
<path fill="none" stroke="black" d="M122.47,-69.31C133.04,-61.31 146.68,-50.99 158.44,-42.08"></path>
<polygon fill="black" stroke="black" points="160.74,-44.73 166.6,-35.91 156.51,-39.15 160.74,-44.73"></polygon>
</g>
<!-- 3&#45;&gt;1 -->
<g id="edge4" class="edge">
<title>3-&gt;1</title>
<path fill="none" stroke="black" d="M162.76,-138.39C141.6,-133.83 108.52,-125.72 81.25,-114.63 71,-110.46 60.26,-104.87 50.88,-99.53"></path>
<polygon fill="black" stroke="black" points="52.41,-96.37 42.01,-94.33 48.87,-102.41 52.41,-96.37"></polygon>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge5" class="edge">
<title>3-&gt;4</title>
<path fill="none" stroke="black" d="M203.73,-129.31C214.29,-121.31 227.93,-110.99 239.69,-102.08"></path>
<polygon fill="black" stroke="black" points="241.99,-104.73 247.85,-95.91 237.77,-99.15 241.99,-104.73"></polygon>
</g>
<!-- 4&#45;&gt;2 -->
<g id="edge6" class="edge">
<title>4-&gt;2</title>
<path fill="none" stroke="black" d="M244.24,-87.37C216.67,-89.77 168.21,-90.02 136.32,-88.11"></path>
<polygon fill="black" stroke="black" points="136.42,-84.61 126.2,-87.39 135.92,-91.6 136.42,-84.61"></polygon>
</g>
<!-- 4&#45;&gt;4 -->
<g id="edge9" class="edge">
<title>4-&gt;4</title>
<path fill="none" stroke="black" d="M252.58,-100.59C248.97,-112.14 253.58,-123.25 266.39,-123.25 275.2,-123.25 280.13,-118 281.18,-110.96"></path>
<polygon fill="black" stroke="black" points="284.62,-110.22 280.21,-100.59 277.66,-110.87 284.62,-110.22"></polygon>
</g>
<!-- 5&#45;&gt;1 -->
<g id="edge8" class="edge">
<title>5-&gt;1</title>
<path fill="none" stroke="black" d="M162.76,-26.86C141.6,-31.42 108.52,-39.54 81.25,-50.63 71,-54.8 60.26,-60.39 50.88,-65.73"></path>
<polygon fill="black" stroke="black" points="48.87,-62.85 42.01,-70.92 52.41,-68.89 48.87,-62.85"></polygon>
</g>
</g>
</svg>
</div>
<p></p><figcaption> 既約なマルコフ連鎖の遷移グラフ。任意の頂点 <span class="math inline">\(u, v\in V\)</span> について、<span class="math inline">\(u\)</span> から <span class="math inline">\(v\)</span> へのウォークが存在する。</figcaption> </figure><p></p>
</div>
</div>
</div>
</section>
<section id="既約なマルコフ連鎖" class="slide level2">
<h2>既約なマルコフ連鎖</h2>
<div id="lem-irred" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3</strong></span> 既約なマルコフ連鎖について <span class="math inline">\(\mathrm{Ker}(I-T)=\mathrm{span}(\mathbf{1})\)</span> である。 ここで<span class="math inline">\(\mathbf{1}\)</span>はすべての成分が1の列ベクトルとする。</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>列ベクトル <span class="math inline">\(v\in\mathbb{R}^n\)</span> を <span class="math display">\[\begin{align*}
(I-T)v = 0 &amp;\iff Tv = v
\end{align*}\]</span> を満たすものとする。 このとき、<span class="math inline">\(i\in\arg\max_{k\in S} v_k\)</span> とすると <span class="math display">\[\begin{align*}
v_i &amp;= \sum_{j\in S} T_{i,j} v_j\\
&amp;= \sum_{j\in S\colon\,(i,j)\in E} T_{i,j} v_j\\
&amp;\le \sum_{j\in S\colon\,(i,j)\in E} T_{i,j} v_i\\
&amp;= v_i
\end{align*}\]</span> という不等式が得られる。 この不等号は等号でなくてはいけないので、 <span class="math display">\[\begin{align*}
v_j &amp;= v_i\qquad\text{if } (i, j)\in E
\end{align*}\]</span> である。 この議論を繰り返すと <span class="math inline">\(i\le_T j\)</span> である <span class="math inline">\(j\)</span> について <span class="math inline">\(v_j=v_i\)</span> である。 マルコフ連鎖が既約であることから、任意の <span class="math inline">\(j\in S\)</span> について <span class="math inline">\(i\le_T j\)</span> であり、<span class="math inline">\(v = v_i \mathbf{1}\)</span> である。 したがって、<span class="math inline">\(\mathrm{Ker}(I-T)=\mathrm{span}(\mathbf{1})\)</span> である。</p>
</div>
<p>よって<strong>既約なマルコフ連鎖に対して定常分布は高々一つ</strong>である。 実際には既約なマルコフ連鎖は一つの定常分布を持つ。</p>
</section>
<section id="既約なマルコフ連鎖の定常分布" class="slide level2">
<h2>既約なマルコフ連鎖の定常分布</h2>
<div id="thm-irred" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> 既約なマルコフ連鎖は<strong>唯一の定常分布</strong> <span class="math inline">\(\mu\in\mathbb{R}_{&gt;0}^n\)</span> を持つ。</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>マルコフ連鎖の<strong>ラプラシアン行列</strong>を <span class="math inline">\(\Lambda \coloneqq I-T\)</span> と定義する。 ラプラシアン行列の余因子行列を <span class="math inline">\(\mathrm{adj}(\Lambda)\)</span> で表す(<span class="math inline">\(\mathrm{adj}(\Lambda)\)</span> の <span class="math inline">\((i,j)\)</span> 成分は <span class="math inline">\((j,i)\)</span> 余因子である)。 余因子展開より <span class="math display">\[\begin{align*}
\mathrm{adj}(\Lambda)\Lambda &amp;= \Lambda\,\mathrm{adj}(\Lambda) = \det(\Lambda)I
\end{align*}\]</span> である。確率行列 <span class="math inline">\(T\)</span> は固有値1を持つので、<span class="math inline">\(\det(\Lambda)=0\)</span> である。 よって、 <span class="math display">\[\begin{align*}
\mathrm{adj}(\Lambda)\Lambda &amp;= \Lambda\,\mathrm{adj}(\Lambda) = O
\end{align*}\]</span> である。 まず、<span class="math inline">\(\Lambda\,\mathrm{adj}(\Lambda)=O\)</span> と <a href="#/lem-irred" class="quarto-xref">Lemma&nbsp;3</a> より <span class="math inline">\(\mathrm{adj}(\Lambda)\)</span> の各列は <span class="math inline">\(\mathbf{1}\)</span> のスカラー倍である。よって、<span class="math inline">\(\mathrm{adj}(\Lambda)\)</span> の行はすべて等しい。 次に、<span class="math inline">\(\mathrm{adj}(\Lambda)\Lambda=O\)</span> より、<span class="math inline">\(\mathrm{adj}(\Lambda)\)</span> の行 <span class="math inline">\(\mu\in\mathbb{R}^n\)</span> は <span class="math inline">\(\mu\Lambda=0\)</span> を満たす。 ここで、<span class="math inline">\(\mathrm{adj}(\Lambda)\)</span> の行がすべて等しいことから <span class="math display">\[\begin{align*}
\mu_i &amp;= \mathrm{adj}(\Lambda)_{i,i}\qquad\forall i\in S
\end{align*}\]</span> が成り立つ。 よって <span class="math display">\[\begin{align*}
\mathrm{adj}(\Lambda)_{i,i}&amp;&gt;0\qquad\forall i\in S
\end{align*}\]</span> を示せば十分である。 余因子行列の定義より、 <span class="math display">\[\begin{align*}
\mathrm{adj}(\Lambda)_{i,i}&amp;= \det(I - T^{(i)})
\end{align*}\]</span> である。 ここで、<span class="math inline">\(T^{(i)}\)</span> は <span class="math inline">\(T\)</span> の <span class="math inline">\(i\)</span> 行目と <span class="math inline">\(i\)</span> 列目を削除して得られる行列である。</p>
<p>目標である <span class="math inline">\(\det(I-T^{(i)})&gt;0\)</span> を示すためには <span class="math inline">\(\rho(T^{(i)})&lt;1\)</span> を示せば十分である。</p>
</div>
</section>
<section id="スペクトル半径と行列式" class="slide level2">
<h2>スペクトル半径と行列式</h2>
<div id="lem-spectral-det" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 4</strong></span> 任意の実正方行列 <span class="math inline">\(A\)</span> について、<span class="math inline">\(\rho(A)&lt;1\)</span> ならば <span class="math inline">\(\det(I-A)&gt;0\)</span> である。</p>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>代数的な証明</strong></p>
</div>
<div class="callout-content">
<p>実正方行列 <span class="math inline">\(A\)</span> の固有値の多重集合を <span class="math inline">\(\mathrm{spec}(A)\)</span> で表すことにする。 実多項式の実数でない根はその複素共役とペアで現れることに注意すると、 <span class="math display">\[\begin{align*}
\det(I-A)&amp;= \prod_{\lambda\in\mathrm{spec}(A)} (1-\lambda)\\
&amp;= \prod_{\lambda\in\mathrm{spec}(A)\cap\mathbb{R}} (1-\lambda)
\cdot \prod_{\lambda\in\mathrm{spec}(A)\setminus\mathbb{R}} (1-\lambda)\\
&amp;= \prod_{\lambda\in\mathrm{spec}(A)\cap\mathbb{R}} (1-\lambda)
\cdot \prod_{\lambda\in\mathrm{spec}(A)\setminus\mathbb{R}} |1-\lambda|\\
\end{align*}\]</span> よって <span class="math inline">\(\rho(A)&lt;1\)</span> であれば <span class="math inline">\(\det(I-A)&gt;0\)</span> である。</p>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>解析的な証明</strong></p>
</div>
<div class="callout-content">
<p>実正方行列 <span class="math inline">\(A\)</span> の特性多項式を <span class="math display">\[\begin{align*}
p_A(x) &amp;\coloneqq \det(xI - A)
\end{align*}\]</span> と定義する。 これはモニックな多項式であるため <span class="math inline">\(x\to+\infty\)</span> で <span class="math inline">\(p_A(x)\to+\infty\)</span> である。 よって <span class="math inline">\(p_A(x)\)</span> が実根を持たないもしくは、すべての実根が 1 未満であれば <span class="math inline">\(p_A(1)&gt;0\)</span> である。 特性多項式 <span class="math inline">\(p_A\)</span> の根は <span class="math inline">\(A\)</span> の固有値なので、<span class="math inline">\(\rho(A)&lt;1\)</span> であれば <span class="math inline">\(p_A(1)=\det(I-A)&gt;0\)</span> である。</p>
</div>
</div>
</div>
</section>
<section id="証明の続き" class="slide level2">
<h2>証明の続き</h2>
<p>よって、<span class="math inline">\(\rho(T^{(i)})&lt;1\)</span> を示せば <span class="math inline">\(\mathrm{adj}(\Lambda)_{i,i}=\det(I-T^{(i)}) &gt; 0\)</span> がしたがう。</p>
<p><span class="math inline">\(T^{(i)}\)</span> の絶対値最大の固有値を <span class="math inline">\(\lambda\)</span> とおき、対応する固有ベクトルを <span class="math inline">\(v\)</span> とする。 このとき <span class="math display">\[\begin{align*}
T^{(i)}v &amp;= \lambda v
\end{align*}\]</span> が成り立つ。 <span class="math inline">\(v\)</span> の絶対値最大の成分のインデックスを <span class="math inline">\(j\in S\setminus\{i\}\)</span> とおく。 マルコフ連鎖が<strong>既約</strong>であることから、その遷移グラフ上で <span class="math inline">\(j\)</span> から <span class="math inline">\(i\)</span> へのウォークが存在する。 そのウォークの長さを <span class="math inline">\(\ell\in\mathbb{Z}_{\ge 1}\)</span> とおく。 このとき、<span class="math inline">\(S\coloneqq T^{(i)\ell}\)</span> とおくと、 <span class="math display">\[\begin{align*}
S v &amp;= \lambda^\ell v
\end{align*}\]</span> である。 ここで、<span class="math inline">\(S\)</span> の <span class="math inline">\(j\)</span> 行目の和は <span class="math display">\[\begin{align*}
\sum_k S_{j,k} &amp;= \Pr(X_1\ne i,\dotsc,X_\ell \ne i\mid X_0 = j) &lt; 1
\end{align*}\]</span> である。 よって、 <span class="math display">\[\begin{align*}
|\lambda^\ell v_j| &amp;= |(S v)_j|
= \left|\sum_{k}S_{j,k} v_k\right|\\
&amp;\le \sum_{k}S_{j,k} \left|v_k\right|
\le \sum_{k}S_{j,k} |v_j| &lt; |v_j|\\
\end{align*}\]</span> である。<span class="math inline">\(|v_j|&gt;0\)</span> より、<span class="math inline">\(|\lambda|&lt;1\)</span> である。 したがって、<span class="math inline">\(\rho(T^{(i)}) &lt; 1\)</span> であることが示された。</p>
</section>
<section id="一般のマルコフ連鎖の定常分布" class="slide level2">
<h2>一般のマルコフ連鎖の定常分布</h2>
<p>次に既約とは限らない一般のマルコフ連鎖について考える。 マルコフ連鎖の状態集合 <span class="math inline">\(S\)</span> を同値関係 <span class="math inline">\(\sim_T\)</span> で割った同値類 <span class="math inline">\(S/\sim_T\)</span> を考える。 そして、その同値類の遷移グラフを考える。</p>
<div id="def-digraph-equiv" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7 (同値類の遷移グラフ)</strong></span> 有向グラフ <span class="math inline">\(G=(V,\,E)\)</span> が状態集合 <span class="math inline">\(S\)</span> 上のマルコフ連鎖の遷移行列 <span class="math inline">\(T\)</span> の<strong>遷移グラフ</strong> <span class="math inline">\(\defiff\)</span> <span class="math display">\[\begin{align*}
V&amp;= S/\sim_T\\
E&amp;=\left\{(A,B)\in V\times V\mid \exists a\in A, b\in B\quad T_{a,b}&gt;0,\,A\ne B\right\}.
\end{align*}\]</span></p>
</div>
<p>マルコフ連鎖の遷移グラフから同値類の遷移グラフは定まる。</p>
<div id="def-digraph-scc" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 8 (強連結成分と縮約グラフ)</strong></span> 有向グラフ <span class="math inline">\(G=(V,E)\)</span> について、<span class="math inline">\(V\)</span> 上の同値関係を <span class="math inline">\(u\sim v\defiff \text{$u$ と $v$ の間に両方向のパスがある}\)</span>と定義す る。 この同値関係の同値類を <span class="math inline">\(G\)</span> の<strong>強連結成分</strong>と呼ぶ。</p>
<p><span class="math inline">\(G\)</span> の強連結成分を頂点に持つ<strong>縮約グラフ</strong> <span class="math inline">\(G'=(V',E')\)</span> を <span class="math display">\[\begin{align*}
V'&amp;=V/\sim\\
E'&amp;=\left\{(A,B)\in V'\times V'\mid \exists a\in A, \exists b\in B, (a,b)\in E, A\ne B\right\}
\end{align*}\]</span> と定義する。</p>
</div>
</section>
<section id="縮約グラフの例" class="slide level2">
<h2>縮約グラフの例</h2>
<div class="cell" data-fig-width="7" data-fig-height="3" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="672" height="288" viewbox="0.00 0.00 378.27 175.58" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 171.58)">
<title>tgraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-171.58 374.27,-171.58 374.27,4 -4,4"></polygon>
<!-- 1 -->
<g id="node1" class="node">
<title>1</title>
<ellipse fill="none" stroke="black" cx="22.63" cy="-93.95" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="22.63" y="-87.95" font-family="Times,serif" font-size="20.00">1</text>
</g>
<!-- 2 -->
<g id="node2" class="node">
<title>2</title>
<ellipse fill="none" stroke="black" cx="103.88" cy="-93.95" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="103.88" y="-87.95" font-family="Times,serif" font-size="20.00">2</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge1" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M45.28,-93.95C53.23,-93.95 62.41,-93.95 71.07,-93.95"></path>
<polygon fill="black" stroke="black" points="71.25,-97.45 81.25,-93.95 71.25,-90.45 71.25,-97.45"></polygon>
</g>
<!-- 7 -->
<g id="node7" class="node">
<title>7</title>
<ellipse fill="none" stroke="black" cx="347.65" cy="-42.95" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="347.65" y="-36.95" font-family="Times,serif" font-size="20.00">7</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge10" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M40.61,-79.57C65.45,-59.58 114.04,-24.33 162.51,-10.95 216.71,4.01 234.59,3.15 289.02,-10.95 299.93,-13.78 310.98,-19.17 320.44,-24.73"></path>
<polygon fill="black" stroke="black" points="318.63,-27.73 328.97,-30.04 322.33,-21.78 318.63,-27.73"></polygon>
</g>
<!-- 3 -->
<g id="node3" class="node">
<title>3</title>
<ellipse fill="none" stroke="black" cx="185.14" cy="-144.95" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="185.14" y="-138.95" font-family="Times,serif" font-size="20.00">3</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge2" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M123.26,-105.78C133.29,-112.23 145.9,-120.35 157.04,-127.52"></path>
<polygon fill="black" stroke="black" points="155.28,-130.54 165.58,-133.01 159.06,-124.66 155.28,-130.54"></polygon>
</g>
<!-- 4 -->
<g id="node4" class="node">
<title>4</title>
<ellipse fill="none" stroke="black" cx="266.39" cy="-105.95" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="266.39" y="-99.95" font-family="Times,serif" font-size="20.00">4</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M126.53,-95.57C154.05,-97.63 201.8,-101.2 233.49,-103.57"></path>
<polygon fill="black" stroke="black" points="233.34,-107.06 243.58,-104.32 233.86,-100.08 233.34,-107.06"></polygon>
</g>
<!-- 5 -->
<g id="node5" class="node">
<title>5</title>
<ellipse fill="none" stroke="black" cx="185.14" cy="-42.95" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="185.14" y="-36.95" font-family="Times,serif" font-size="20.00">5</text>
</g>
<!-- 2&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>2-&gt;5</title>
<path fill="none" stroke="black" d="M123.26,-82.12C133.29,-75.67 145.9,-67.55 157.04,-60.39"></path>
<polygon fill="black" stroke="black" points="159.06,-63.25 165.58,-54.89 155.28,-57.36 159.06,-63.25"></polygon>
</g>
<!-- 3&#45;&gt;1 -->
<g id="edge3" class="edge">
<title>3-&gt;1</title>
<path fill="none" stroke="black" d="M162.32,-142.99C141.12,-140.61 108.26,-135.65 81.25,-125.95 70.83,-122.21 60.06,-116.73 50.69,-111.35"></path>
<polygon fill="black" stroke="black" points="52.23,-108.19 41.85,-106.08 48.64,-114.21 52.23,-108.19"></polygon>
</g>
<!-- 4&#45;&gt;7 -->
<g id="edge8" class="edge">
<title>4-&gt;7</title>
<path fill="none" stroke="black" d="M284.59,-92.28C295.39,-83.7 309.51,-72.47 321.55,-62.9"></path>
<polygon fill="black" stroke="black" points="323.83,-65.56 329.48,-56.59 319.48,-60.08 323.83,-65.56"></polygon>
</g>
<!-- 6 -->
<g id="node6" class="node">
<title>6</title>
<ellipse fill="none" stroke="black" cx="266.39" cy="-42.95" rx="22.76" ry="22.76"></ellipse>
<text text-anchor="middle" x="266.39" y="-36.95" font-family="Times,serif" font-size="20.00">6</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>5-&gt;6</title>
<path fill="none" stroke="black" d="M206.96,-36.93C215.36,-36.23 225.22,-36.03 234.43,-36.35"></path>
<polygon fill="black" stroke="black" points="234.25,-39.84 244.43,-36.92 234.65,-32.85 234.25,-39.84"></polygon>
</g>
<!-- 6&#45;&gt;5 -->
<g id="edge7" class="edge">
<title>6-&gt;5</title>
<path fill="none" stroke="black" d="M244.43,-48.99C236.02,-49.68 226.15,-49.87 216.95,-49.55"></path>
<polygon fill="black" stroke="black" points="217.15,-46.06 206.96,-48.97 216.74,-53.04 217.15,-46.06"></polygon>
</g>
<!-- 6&#45;&gt;7 -->
<g id="edge9" class="edge">
<title>6-&gt;7</title>
<path fill="none" stroke="black" d="M289.05,-42.95C297,-42.95 306.17,-42.95 314.83,-42.95"></path>
<polygon fill="black" stroke="black" points="315.02,-46.45 325.02,-42.95 315.02,-39.45 315.02,-46.45"></polygon>
</g>
<!-- 7&#45;&gt;7 -->
<g id="edge11" class="edge">
<title>7-&gt;7</title>
<path fill="none" stroke="black" d="M333.83,-60.91C330.23,-72.46 334.83,-83.58 347.65,-83.58 356.46,-83.58 361.38,-78.32 362.43,-71.29"></path>
<polygon fill="black" stroke="black" points="365.88,-70.54 361.46,-60.91 358.91,-71.2 365.88,-70.54"></polygon>
</g>
</g>
</svg>
</div>
<p></p><figcaption> 有向グラフの例。強連結ではない。</figcaption> </figure><p></p>
</div>
</div>
</div>
<div class="cell" data-fig-width="7" data-fig-height="3" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="672" height="288" viewbox="0.00 0.00 209.00 125.06" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 121.06)">
<title>tgraph_equiv</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-121.06 205,-121.06 205,4 -4,4"></polygon>
<!-- a -->
<g id="node1" class="node">
<title>a</title>
<ellipse fill="none" stroke="black" cx="21.5" cy="-34.56" rx="21.5" ry="21.5"></ellipse>
<text text-anchor="middle" x="21.5" y="-31.56" font-family="Times,serif" font-size="10.00">{1, 2, 3}</text>
</g>
<!-- b -->
<g id="node2" class="node">
<title>b</title>
<ellipse fill="none" stroke="black" cx="100.5" cy="-95.56" rx="21.5" ry="21.5"></ellipse>
<text text-anchor="middle" x="100.5" y="-92.56" font-family="Times,serif" font-size="10.00">{4}</text>
</g>
<!-- a&#45;&gt;b -->
<g id="edge1" class="edge">
<title>a-&gt;b</title>
<path fill="none" stroke="black" d="M38.83,-47.5C49.34,-55.83 63.21,-66.81 75.03,-76.17"></path>
<polygon fill="black" stroke="black" points="73.18,-79.17 83.19,-82.64 77.53,-73.69 73.18,-79.17"></polygon>
</g>
<!-- c -->
<g id="node3" class="node">
<title>c</title>
<ellipse fill="none" stroke="black" cx="100.5" cy="-34.56" rx="21.5" ry="21.5"></ellipse>
<text text-anchor="middle" x="100.5" y="-31.56" font-family="Times,serif" font-size="10.00">{5, 6}</text>
</g>
<!-- a&#45;&gt;c -->
<g id="edge3" class="edge">
<title>a-&gt;c</title>
<path fill="none" stroke="black" d="M43.13,-34.56C50.99,-34.56 60.12,-34.56 68.71,-34.56"></path>
<polygon fill="black" stroke="black" points="68.81,-38.06 78.81,-34.56 68.81,-31.06 68.81,-38.06"></polygon>
</g>
<!-- d -->
<g id="node4" class="node">
<title>d</title>
<ellipse fill="none" stroke="black" cx="179.5" cy="-34.56" rx="21.5" ry="21.5"></ellipse>
<text text-anchor="middle" x="179.5" y="-31.56" font-family="Times,serif" font-size="10.00">{7}</text>
</g>
<!-- a&#45;&gt;d -->
<g id="edge2" class="edge">
<title>a-&gt;d</title>
<path fill="none" stroke="black" d="M39.36,-22.37C50.12,-15.35 64.69,-7.23 79,-3.56 97.51,1.19 103.49,1.19 122,-3.56 132.73,-6.31 143.61,-11.57 152.92,-16.98"></path>
<polygon fill="black" stroke="black" points="151.3,-20.09 161.64,-22.37 154.97,-14.14 151.3,-20.09"></polygon>
</g>
<!-- b&#45;&gt;d -->
<g id="edge4" class="edge">
<title>b-&gt;d</title>
<path fill="none" stroke="black" d="M117.83,-82.62C128.34,-74.29 142.21,-63.31 154.03,-53.95"></path>
<polygon fill="black" stroke="black" points="156.53,-56.43 162.19,-47.48 152.18,-50.94 156.53,-56.43"></polygon>
</g>
<!-- c&#45;&gt;d -->
<g id="edge5" class="edge">
<title>c-&gt;d</title>
<path fill="none" stroke="black" d="M122.13,-34.56C129.99,-34.56 139.12,-34.56 147.71,-34.56"></path>
<polygon fill="black" stroke="black" points="147.81,-38.06 157.81,-34.56 147.81,-31.06 147.81,-38.06"></polygon>
</g>
</g>
</svg>
</div>
<p></p><figcaption> 上の図の有向グラフの縮約グラフ。</figcaption> </figure><p></p>
</div>
</div>
</div>
</section>
<section id="再帰的な状態と一般のマルコフ連鎖の定常分布" class="slide level2">
<h2>再帰的な状態と一般のマルコフ連鎖の定常分布</h2>
<p>DAG(サイクルを持たない有向グラフ)の頂点で出次数(外に出ていく有向辺の個数)が0のものをシンクという。 (有限サイズの)DAGは必ずシンクを一つ以上持つ。 一般のマルコフ連鎖の定常分布について、その同値類の遷移グラフを用いて考察する。 マルコフ連鎖の同値類の遷移グラフにおいてシンクに対応する同値類やそれに含まれる状態を<strong>再帰的</strong>であるという。</p>
<p>以下、簡単に一般のマルコフ連鎖の定常分布について概要を説明する。</p>
<div id="lem-stat-trans" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 5</strong></span> マルコフ連鎖の定常分布を <span class="math inline">\(\mu\in\mathbb{R}^n\)</span> とすると、再帰的でない状態 <span class="math inline">\(s\in S\)</span> について <span class="math inline">\(\mu(s)=0\)</span> である。</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>(証明の概要) 再帰的でない状態 <span class="math inline">\(s\)</span> が正の確率 <span class="math inline">\(\mu(s)&gt;0\)</span> を持つ定常分布が存在すると仮定する。 状態 <span class="math inline">\(s\)</span> から何らかの再帰的な状態 <span class="math inline">\(t\)</span> へ正の確率で遷移する。よってマルコフ連鎖を進めることで、 <span class="math inline">\(t\)</span> が属する同値類の確率の総和が増加する。 定常分布はマルコフ連鎖の遷移で変化しない分布であるので、これは矛盾である。</p>
</div>
<p>よって、一般的なマルコフ連鎖の定常分布を考える上では再帰的でない状態は存在しないものとして考えることができる。 再帰的な同値類は互いに遷移できない。また、再帰的な同値類それぞれに唯一の定常分布が存在する。 そして、それらの凸結合(確率混合)もまた定常分布である。 これらですべての定常状態を表すことができる。 これがマルコフ連鎖の定常分布の一般論である。</p>
</section>
<section id="今週の課題" class="slide level2">
<h2>今週の課題</h2>
<p>以下の推移行列を持つマルコフ連鎖の遷移グラフを描け。 状態のラベルは行と列のインデックスに対応して <span class="math inline">\(1,2,\dotsc,\)</span> の順番で付けるとする。 また、それぞれのマルコフ連鎖が既約であるか判定せよ。 既約である場合は「既約である」、 既約でない場合は「状態 <span class="math inline">\(i\)</span> から状態 <span class="math inline">\(j\)</span> へ遷移できないため既約でない」と記せ。 既約でないことを示すための状態ペア <span class="math inline">\((i,\,j)\)</span> は一つ示せばよい。</p>
<div style="font-size:0.8em">
<ol type="1">
<li><span class="math display">\[\begin{align*}
\begin{bmatrix}
1/2&amp;1/3&amp;1/6\\
1/4&amp;1/2&amp;1/4\\
1/3&amp;1/3&amp;1/3
\end{bmatrix}.
\end{align*}\]</span></li>
<li><span class="math display">\[\begin{align*}
\begin{bmatrix}
0&amp;1&amp;0\\
0&amp;0&amp;1\\
1&amp;0&amp;0
\end{bmatrix}.
\end{align*}\]</span></li>
<li><span class="math display">\[\begin{align*}
\begin{bmatrix}
1/2&amp;1/2&amp;0\\
0&amp;1/2&amp;1/2\\
0&amp;0&amp;1
\end{bmatrix}.
\end{align*}\]</span></li>
<li><span class="math display">\[\begin{align*}
\begin{bmatrix}
1/2&amp;1/2&amp;0&amp;0\\
1/3&amp;2/3&amp;0&amp;0\\
0&amp;0&amp;0&amp;1\\
0&amp;0&amp;1&amp;0
\end{bmatrix}.
\end{align*}\]</span></li>
</ol>
</div>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/Prob-Stat\.github\.io\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>